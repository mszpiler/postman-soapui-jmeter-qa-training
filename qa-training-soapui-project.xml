<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="d34513e2-75c0-4717-91d0-04c0232e9745" activeEnvironment="Default" name="qa-training" resourceRoot="" soapui-version="5.5.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config">
  <con:settings/>
  <con:interface xsi:type="con:RestService" id="ea28fca4-2da8-4d41-bf5c-5ab89d021eab" wadlVersion="http://wadl.dev.java.net/2009/02" name="Pokakota API" type="rest" basePath="/norad" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:description>Pokakota API documentation</con:description>
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints>
      <con:endpoint>http://localhost:8600</con:endpoint>
    </con:endpoints>
    <con:resource name="/accounts" path="/accounts" id="71d56b05-d8a2-483d-b80e-3eaac8aba97e">
      <con:settings/>
      <con:parameters/>
      <con:method name="createUsingPOST" id="e06304a0-0af3-4eba-b605-43d80702ca62" method="POST">
        <con:description>Creates new foobar.
Creates foobar</con:description>
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>201</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>409</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>500 400</con:status>
          <con:params/>
          <con:element xmlns:acc="http://localhost/norad/accounts">acc:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:acc="http://localhost/norad/accounts">acc:Response</con:element>
        </con:representation>
        <con:request name="Request 1" id="632db7ba-1289-4bfd-8852-7046a43d098a" mediaType="application/json" postQueryString="false">
          <con:settings/>
          <con:endpoint>http://localhost:8600</con:endpoint>
          <con:request/>
          <con:credentials>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:jmsPropertyConfig/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="/accounts/{uuid}" path="/accounts/{uuid}" id="9b683e99-7b20-464a-8184-c829b7919f55">
      <con:settings/>
      <con:parameters/>
      <con:method name="getUserUsingGET" id="77a1ce3a-82b2-487e-987f-f99c7b9d538c" method="GET">
        <con:description>Gets user by uuid
Get user by uuid</con:description>
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>uuid</con:name>
            <con:style>TEMPLATE</con:style>
            <con:description>uuid</con:description>
          </con:parameter>
        </con:parameters>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="f60102e2-9560-423c-8cef-caa61eaa7477" mediaType="application/json">
          <con:settings/>
          <con:endpoint>http://localhost:8600</con:endpoint>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="/animals" path="/animals" id="73ba0513-3d45-43cf-bb00-9d6a50ca9793">
      <con:settings/>
      <con:parameters/>
      <con:method name="createUsingPOST_1" id="b3edd166-ec36-4fed-a47c-09b6f0b3d441" method="POST">
        <con:description>Creates new animal.
Creates animal</con:description>
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>201</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>409</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="34864ad4-e7f6-476a-9004-ba838a8439fc" mediaType="application/json">
          <con:settings/>
          <con:endpoint>http://localhost:8600</con:endpoint>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="/animals/{uuid}" path="/animals/{uuid}" id="cbee9412-22e8-4a83-8d35-f5e98f01f5a3">
      <con:settings/>
      <con:parameters/>
      <con:method name="getAnimalUsingGET" id="04c5f879-6e47-4652-9b86-9a429bf34f8f" method="GET">
        <con:description>Gets animal by uuid
Get animal by uuid</con:description>
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>uuid</con:name>
            <con:style>TEMPLATE</con:style>
            <con:description>uuid</con:description>
          </con:parameter>
        </con:parameters>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="4d3995c8-5e27-418c-8893-2350b781b02e" mediaType="application/json">
          <con:settings/>
          <con:endpoint>http://localhost:8600</con:endpoint>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="/dictionaries/races" path="/dictionaries/races" id="2a8fbcbc-898b-4a89-b638-beb529161cf1">
      <con:settings/>
      <con:parameters/>
      <con:method name="getRacesUsingGET" id="e2cdbb38-cacf-4a19-93a5-2c00d82d4fdc" method="GET">
        <con:description>Gets all races
Get all races</con:description>
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element>Response</con:element>
        </con:representation>
        <con:request name="Request 1" id="6417fe4a-7807-4930-a665-1852b26037e6" mediaType="application/json">
          <con:settings/>
          <con:endpoint>http://localhost:8600</con:endpoint>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="/foobar" path="/foobar" id="1cffca82-bf52-4ca2-ae5a-09a08be2abdb">
      <con:settings/>
      <con:parameters/>
      <con:method name="createUsingPOST_2" id="058a6637-12be-4495-a586-5b2a9024ae9d" method="POST">
        <con:description>Creates new foobar.
Creates foobar</con:description>
        <con:settings/>
        <con:parameters/>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>201</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>409</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="0dd244cd-ac16-4a85-ae78-0143a1795ccd" mediaType="application/json">
          <con:settings/>
          <con:endpoint>http://localhost:8600</con:endpoint>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="/foobar/{uuid}" path="/foobar/{uuid}" id="c096c60e-3a9b-4078-971f-8668d0207db7">
      <con:settings/>
      <con:parameters/>
      <con:method name="getFoobarUsingGET" id="45a2574c-7cfd-4f3b-af8e-1446108b0ec8" method="GET">
        <con:description>Gets all foobars for logged user.
Get all foobars for logged user.</con:description>
        <con:settings/>
        <con:parameters>
          <con:parameter required="true">
            <con:name>uuid</con:name>
            <con:style>TEMPLATE</con:style>
            <con:description>uuid</con:description>
          </con:parameter>
        </con:parameters>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>401</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>403</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>*/*</con:mediaType>
          <con:status>404</con:status>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="ecb769c2-358d-4182-8886-84effa3f655d" mediaType="application/json">
          <con:settings/>
          <con:endpoint>http://localhost:8600</con:endpoint>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:testSuite id="1e8f1ed4-d847-4af6-abf9-6d54693dadb0" name="Pokakota Suite">
    <con:settings/>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="0403361c-8ac8-4bdd-bf08-3fa5f9894b4d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Exercise 1 - Get all Races" searchProperties="true">
      <con:settings/>
      <con:testStep type="restrequest" name="Get all races" id="14f485d2-dac3-496f-8859-e290a793c8e9">
        <con:settings/>
        <con:config service="Pokakota API" resourcePath="/norad/dictionaries/races" methodName="getRacesUsingGET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Get all races" id="6417fe4a-7807-4930-a665-1852b26037e6" mediaType="application/json">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>http://localhost:8600</con:endpoint>
            <con:request/>
            <con:originalUri>http://localhost/norad/dictionaries/races</con:originalUri>
            <con:assertion type="Valid HTTP Status Codes" id="03c1e7a5-0508-436b-b291-a723c884a9f8" name="Valid HTTP Status Codes">
              <con:configuration>
                <codes>200</codes>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Count" id="70e3e664-4881-491d-a977-eb38b1db6ed9" name="JsonPath Count">
              <con:configuration>
                <path>$</path>
                <content>10</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:assertion type="JsonPath Match" id="b652af6a-2a05-4963-966d-a790db9e0453" name="JsonPath Match">
              <con:configuration>
                <path>$[4].name</path>
                <content>Kot egzotyczny</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties/>
    </con:testCase>
    <con:testCase id="847e256a-dfbb-4137-808f-f760d6512867" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Exercise 2 - Register user" searchProperties="true">
      <con:settings/>
      <con:testStep type="groovy" name="Generate email" id="2ebe97fb-a2e0-48b5-9176-cc1a1cbc8dfe">
        <con:settings/>
        <con:config>
          <script>import org.apache.commons.lang.RandomStringUtils
String charset = (('A'..'Z') + ('0'..'9')).join()
Integer length = 9
String randomString = RandomStringUtils.random(length, charset.toCharArray())
String value = "mszpiler+"+randomString+"@pokakota.com";
testRunner.testCase.setPropertyValue("email", value)
log.info value;</script>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Register user" id="da98be0f-533d-494f-a53b-d500a3bc50b2">
        <con:settings/>
        <con:config service="Pokakota API" resourcePath="/norad/accounts" methodName="createUsingPOST" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Register user" id="632db7ba-1289-4bfd-8852-7046a43d098a" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>http://localhost:8600</con:endpoint>
            <con:request>{
	"email" : "${#TestCase#email}",
	"password": "password"
}</con:request>
            <con:originalUri>http://localhost/norad/accounts</con:originalUri>
            <con:assertion type="JsonPath Match" id="c1df1ed3-7117-47fc-b96a-4e9f21aae635" name="JsonPath Match">
              <con:configuration>
                <path>$.email</path>
                <content>${#TestCase#email}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
                <ignoreComments>false</ignoreComments>
              </con:configuration>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion" id="6277ddb8-0a93-4c04-8e6f-c3c7b40f8d76" name="Script Assertion">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="GroovyScriptAssertion"/>
            <con:assertion type="GroovyScriptAssertion" id="f1be687c-22c0-443e-93e4-362a7398ff45" name="Check DB">
              <con:configuration>
                <scriptText>import groovy.sql.Sql
import java.sql.Driver

def driver = Class.forName('org.postgresql.Driver').newInstance() as Driver 

def props = new Properties()
props.setProperty("user", "pkko") 
props.setProperty("password", "pkko")

def conn = driver.connect("jdbc:postgresql://localhost:8200/pkko_db", props) 
def sql = new Sql(conn)
def testCase = messageExchange.modelItem.testCase
def email = testCase.getPropertyValue("email")
log.info "Email="+email;
try {
	def row = sql.firstRow('select * from norad.users where email = :email', [email: email])    
    assert row.email == email;
} catch (Exception e) {
	log.info(e.getMessage())
	 assert false;
}
finally {
    sql.close()
    conn.close()
}</scriptText>
              </con:configuration>
            </con:assertion>
            <con:credentials>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:properties>
        <con:property>
          <con:name>email</con:name>
          <con:value>mszpiler+IMEL3TLY4@pokakota.com</con:value>
        </con:property>
      </con:properties>
    </con:testCase>
    <con:properties/>
  </con:testSuite>
  <con:properties/>
  <con:wssContainer/>
  <con:oAuth2ProfileContainer/>
  <con:oAuth1ProfileContainer/>
  <con:sensitiveInformation/>
</con:soapui-project>
